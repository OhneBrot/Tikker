<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Tikker – Preis-/Mengen-Rechner</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="color-scheme" content="light dark">

  <!-- PWA essentials -->
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0a0a0a" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="icons/apple-touch-icon-180.png">

  <style>
    :root { --maxw: 430px; }
    /* ✅ Notch / Safe-Area fix */
    html, body { padding-top: env(safe-area-inset-top); padding-bottom: env(safe-area-inset-bottom); }
    body { background: #fafafa; }
    @media (prefers-color-scheme: dark){ body{ background:#0a0a0a; } }

    .card{ border-radius: 1.25rem; border:1px solid rgb(228,228,231); background:white; box-shadow: 0 1px 3px rgba(0,0,0,.06); }
    @media (prefers-color-scheme: dark){ .card{ background:#111; border-color:#27272a; } }
    .field{ border-radius: 1rem; border:1px solid rgb(212,212,216); background:white; }
    @media (prefers-color-scheme: dark){ .field{ background:#0b0b0b; border-color:#27272a; color:#e5e7eb; } }
    .muted{ color: #71717a; }
    @media (prefers-color-scheme: dark){ .muted{ color:#a1a1aa; } }
    .hiddenView{ display:none; }
    .tile{ aspect-ratio: 1/1; }

    #app-root{ opacity:0; transform: translateX(24px); transition: transform .45s cubic-bezier(.22,.61,.36,1), opacity .45s ease; }
    #app-root.enter{ opacity:1; transform: translateX(0); }

    #app-loader{ position:fixed; inset:0; display:grid; place-items:center; background:rgba(255,255,255,.92); z-index:50; transition:opacity .35s ease; }
    @media (prefers-color-scheme: dark){ #app-loader{ background:rgba(10,10,10,.92); } }
    .hub{ position:relative; width:140px; height:140px; transform: rotate(0deg); transition: transform .13s cubic-bezier(.22,.61,.36,1); }
    .blade{ position:absolute; left:50%; top:50%; width:88px; height:18px; transform-origin: 10px 50%; border-radius: 999px; background: linear-gradient(145deg, rgba(255,255,255,0.35), rgba(255,255,255,0.08)); border:1px solid rgba(255,255,255,0.55); backdrop-filter: blur(8px) saturate(140%); -webkit-backdrop-filter: blur(8px) saturate(140%); box-shadow: 0 10px 22px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.65), inset 0 -1px 0 rgba(255,255,255,.25); }
    .blade::after{ content:""; position:absolute; inset:0; border-radius:inherit; background: linear-gradient(120deg, rgba(255,255,255,.55) 0%, rgba(255,255,255,.15) 35%, rgba(255,255,255,0) 60%); mix-blend-mode:screen; opacity:.9; }
    @media (prefers-color-scheme: dark){ .blade{ background: linear-gradient(145deg, rgba(255,255,255,0.18), rgba(255,255,255,0.06)); border-color: rgba(255,255,255,0.28); box-shadow: 0 14px 28px rgba(0,0,0,.5), inset 0 1px 0 rgba(255,255,255,.22), inset 0 -1px 0 rgba(255,255,255,.08);} .blade::after{ background: linear-gradient(120deg, rgba(255,255,255,.35) 0%, rgba(255,255,255,.12) 35%, rgba(255,255,255,0) 60%);} }
    .b0{ transform: translate(-50%,-50%) rotate(0deg); }
    .b1{ transform: translate(-50%,-50%) rotate(90deg); }
    .b2{ transform: translate(-50%,-50%) rotate(180deg); }
    .b3{ transform: translate(-50%,-50%) rotate(270deg); }
    .blade.fly{ transition: transform .18s cubic-bezier(.22,.61,.36,1), opacity .18s ease; opacity:0; }

    .appbar{ backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); background: linear-gradient(180deg, rgba(255,255,255,.68), rgba(255,255,255,.48)); border: 1px solid rgba(228,228,231,.6); box-shadow: 0 8px 24px rgba(0,0,0,.06); }
    @media (prefers-color-scheme: dark){ .appbar{ background: linear-gradient(180deg, rgba(24,24,27,.55), rgba(24,24,27,.35)); border-color: rgba(63,63,70,.6); box-shadow: 0 8px 24px rgba(0,0,0,.35);} }

    .logo{ font-weight: 900; letter-spacing: .04em; line-height: 1; text-shadow: 0 10px 26px rgba(0,0,0,.3); }
    @media (prefers-color-scheme: dark){ .logo{ text-shadow: 0 10px 26px rgba(0,0,0,.45); } }
    .logo-icon{ width: 28px; height: 28px; flex-shrink:0; display:inline-block; background: linear-gradient(145deg, rgba(255,255,255,0.5), rgba(255,255,255,0.2)); backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px); border: 1px solid rgba(255,255,255,0.4); border-radius: 50%; position: relative; box-shadow: inset 0 0 4px rgba(255,255,255,0.5), 0 2px 6px rgba(0,0,0,0.15); }
    .logo-icon::before{ content: ""; position:absolute; inset:4px; border: 2px solid rgba(0,0,0,0.5); border-radius:50%; }
    .logo-icon::after{ content: "€"; position:absolute; font-size:14px; color:rgba(0,0,0,0.65); top:50%; left:50%; transform:translate(-50%,-50%); }
    @media (prefers-color-scheme: dark){ .logo-icon{ background: linear-gradient(145deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)); border-color: rgba(255,255,255,0.15);} .logo-icon::before{ border-color: rgba(255,255,255,0.4);} .logo-icon::after{ color: rgba(255,255,255,0.8);} }
  </style>
</head>
<body class="min-h-screen">
  <div id="app-loader">
    <div id="hub" class="hub">
      <div class="blade b0" data-dir="right"></div>
      <div class="blade b1" data-dir="down"></div>
      <div class="blade b2" data-dir="left"></div>
      <div class="blade b3" data-dir="up"></div>
    </div>
  </div>

  <main id="app-root" class="mx-auto min-h-screen max-w-[var(--maxw)] p-3 relative">
    <header class="sticky top-0 z-10 mb-3 rounded-3xl appbar p-3">
      <div class="flex items-center justify-between gap-3">
        <div class="flex items-center gap-3">
          <button id="backBtn" aria-label="Zurück" class="hidden h-9 w-9 shrink-0 grid place-items-center rounded-2xl border border-zinc-300/60 text-zinc-700 dark:border-zinc-700/60 dark:text-zinc-200">←</button>
          <div class="flex items-center gap-2">
            <span class="logo-icon"></span>
            <div class="logo text-3xl tracking-wide text-zinc-900 dark:text-zinc-100">Tikker</div>
          </div>
        </div>
        <div class="relative">
          <button id="unitBtn" class="rounded-2xl border border-zinc-300/60 px-3 py-1.5 text-sm dark:border-zinc-700/60 bg-white/40 dark:bg-zinc-900/30">g ▾</button>
        </div>
      </div>
    </header>

    <!-- Deine Inhalte -->

  </main>

  <script>
    function hideLoader(){
      const loader = document.getElementById('app-loader');
      if(loader){
        loader.style.opacity = '0';
        setTimeout(()=> loader.remove(), 250);
      }
      const app = document.getElementById('app-root');
      if(app) app.classList.add('enter');
    }

    document.addEventListener('DOMContentLoaded', async () => {
      try {
        // Initialisierungen
        if(typeof bindInputs === "function") bindInputs();
        if(typeof setUnit === "function") setUnit('g');
        if(typeof setView === "function") setView('home');

        const fallback = setTimeout(hideLoader, 1200);
        if(typeof startLoader === "function") await startLoader();
        clearTimeout(fallback);
        hideLoader();
      } catch (e) {
        hideLoader();
        console.warn('Init-Fehler:', e);
      }
    });

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js').catch(console.warn);
      });
    }
  </script>
</body>
</html>
