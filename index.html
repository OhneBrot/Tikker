<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Tikker</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
    body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
        background: #111;
        color: #fff;
        margin: 0;
        padding: 0;
    }
    /* Loader Overlay */
    #loader {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.85);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        transition: opacity 0.5s ease;
    }
    .hand {
        width: 6px;
        height: 64px;
        background: rgba(255,255,255,0.9);
        border-radius: 3px;
        transform-origin: bottom center;
        animation: spin 1s linear infinite;
        box-shadow: 0 8px 18px rgba(0,0,0,0.45);
    }
    @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }
    /* UI */
    .container {
        max-width: 560px;
        margin: 40px auto;
        padding: 20px;
        background: rgba(255,255,255,0.05);
        border-radius: 12px;
        backdrop-filter: blur(6px);
    }
    h1 { margin: 0 0 12px; font-size: 22px; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .row-1 { display: grid; grid-template-columns: 1fr; gap: 10px; }
    input, button {
        padding: 12px 14px;
        border-radius: 10px;
        border: none;
        font-size: 16px;
    }
    input {
        width: 100%;
        background: rgba(255,255,255,0.1);
        color: white;
        outline: none;
    }
    input::placeholder { color: rgba(255,255,255,0.6); }
    button {
        cursor: pointer;
        margin: 5px 0;
        background: #e5e7eb;
    }
    .btn-primary { background: #16a34a; color: white; }
    .btn-danger  { background: #dc2626; color: white; }
    table {
        width: 100%;
        margin-top: 15px;
        border-collapse: collapse;
    }
    th, td {
        padding: 10px;
        border-bottom: 1px solid rgba(255,255,255,0.1);
        text-align: left;
        font-size: 15px;
    }
    .actions { display: flex; gap: 8px; }
    .hint { color: rgba(255,255,255,0.7); font-size: 13px; margin-top: 6px; }
</style>
</head>
<body>

<!-- Loader -->
<div id="loader" aria-hidden="true">
    <div class="hand" role="img" aria-label="Ladeanimation"></div>
</div>

<div class="container">
    <h1>Für Kunden</h1>

    <div class="row-1">
        <input id="name" placeholder="Name">
    </div>
    <div class="row">
        <input id="datum" placeholder="Datum (TT.MM)">
        <input id="anzahl" placeholder="Stückzahl" inputmode="decimal">
    </div>
    <div class="row">
        <input id="betrag" placeholder="Betrag in €" inputmode="decimal">
        <input id="note" placeholder="Anmerkungen (optional)">
    </div>

    <div class="actions">
        <button id="addBtn" class="btn-primary">Hinzufügen</button>
        <button id="clearBtn" class="btn-danger">Leeren</button>
    </div>

    <div class="hint">Einträge bleiben lokal gespeichert (LocalStorage).</div>

    <table aria-label="Gespeicherte Einträge">
        <thead>
            <tr>
                <th>Name</th>
                <th>Datum</th>
                <th>Stückzahl</th>
                <th>Betrag</th>
                <th>Anmerkungen</th>
                <th></th>
            </tr>
        </thead>
        <tbody id="list"></tbody>
    </table>
</div>

<script>
    const loader = document.getElementById('loader');
    const listEl = document.getElementById('list');
    const addBtn  = document.getElementById('addBtn');
    const clearBtn= document.getElementById('clearBtn');

    let eintraege = [];
    const KEY = 'tikkerListe';

    function save() {
        localStorage.setItem(KEY, JSON.stringify(eintraege));
    }

    function load() {
        try {
            const raw = localStorage.getItem(KEY);
            eintraege = raw ? JSON.parse(raw) : [];
            if (!Array.isArray(eintraege)) eintraege = [];
        } catch(e) {
            eintraege = [];
        }
    }

    function renderListe() {
        listEl.innerHTML = '';
        eintraege.forEach((e, i) => {
            const tr = document.createElement('tr');
            tr.innerHTML = \`
                <td>\${e.name || ''}</td>
                <td>\${e.datum || ''}</td>
                <td>\${e.anzahl || ''}</td>
                <td>\${e.betrag ? (Number(e.betrag).toLocaleString('de-DE', {style:'currency', currency:'EUR'})) : ''}</td>
                <td>\${e.note || ''}</td>
                <td><button data-i="\${i}" class="btn-danger" style="padding:6px 10px">Quitt</button></td>
            \`;
            listEl.appendChild(tr);
        });
        listEl.querySelectorAll('button[data-i]').forEach(btn => {
            btn.addEventListener('click', (ev) => {
                const i = Number(ev.currentTarget.dataset.i);
                if (!Number.isInteger(i)) return;
                eintraege.splice(i, 1);
                save();
                renderListe();
            });
        });
        save();
    }

    addBtn.addEventListener('click', () => {
        const name   = document.getElementById('name').value.trim();
        const datum  = document.getElementById('datum').value.trim();
        const anzahl = document.getElementById('anzahl').value.trim();
        const betrag = document.getElementById('betrag').value.trim();
        const note   = document.getElementById('note').value.trim();

        if (!name || !datum || !anzahl || !betrag) {
            alert("Bitte alle Pflichtfelder ausfüllen (Name, Datum, Stückzahl, Betrag).");
            return;
        }
        eintraege.push({ name, datum, anzahl, betrag: betrag.replace(',', '.'), note });
        renderListe();

        document.getElementById('name').value = '';
        document.getElementById('datum').value = '';
        document.getElementById('anzahl').value = '';
        document.getElementById('betrag').value = '';
        document.getElementById('note').value = '';
    });

    clearBtn.addEventListener('click', () => {
        if (confirm("Wirklich gesamte Liste löschen?")) {
            eintraege = [];
            renderListe();
        }
    });

    function startLoader() {
        setTimeout(() => {
            loader.style.opacity = 0;
            loader.style.pointerEvents = 'none';
            setTimeout(() => loader.remove(), 500);
        }, 1100);
    }

    load();
    renderListe();
    startLoader();
</script>

</body>
</html>
